<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset='utf-8'>
	<meta name='viewport' content='width=device-width,initial-scale=1'>

	<title>AD4M Connection Wizard</title>

	<link rel='icon' type='image/png' href='favicon.png'>
	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link href="https://fonts.googleapis.com/css2?family=Monoton&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<script>var exports = {};</script>
		
</head>

<body>
	<div id="container">
	</div>
	<script type="module">
		const { ipcRenderer } = require("electron");

		import Ad4mConnect from "../dist/web.js";
		const { appName, appIconPath, executorUrl, capabilityToken, capabilities } = ipcRenderer.sendSync('get');
		console.log('capabilities', capabilities)
		const ele = document.createElement('ad4m-connect');
		ele.appname = appName;
		ele.appiconpath = appIconPath;
		ele.url = executorUrl;
		ele.token = capabilityToken;
		ele.capabilities = JSON.stringify(capabilities)
		document.body.appendChild(ele);
		const client = ele.getClient();
		client.addEventListener('connected_with_capabilities', (jwt) => {
			ipcRenderer.send('resolve', { executorUrl, capabilityToken, client });
		})
	</script>
</body>
</html>
